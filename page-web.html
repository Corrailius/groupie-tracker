<!DOCTYPE html>
<html>
<head>
<title>Groupie Tracker</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/CSS/page-Style.css">

</head>

<body>
<header>
  <h1>Groupie Trackers</h1>
  <p>Liste de 52 artistes majeurs de la musique moderne.</p>
</header>

<div class="navbar">
  <a href="https://groupietrackers.herokuapp.com/api/artists">Artiste</a>
  <a href="https://groupietrackers.herokuapp.com/api/locations">locations</a>
  <a href="https://groupietrackers.herokuapp.com/api/dates">Date</a>
  <a href="https://groupietrackers.herokuapp.com/api/relation">relation</a>
</div>

<div class="container">
  <div class="side">
    <h2>Trie :</h2>
    <button onclick="sortArtists()">Ordre Alphabetique </button><br>
    <button onclick="sortArtistsByCreationDate()">Date de Cr√©ation</button><br>
    <button onclick="premierAlbum()">Premier Album</button><br>
    <button onclick="numberMenber()">Nombre de Membres</button>
  </div>

  <div class="main">

    <!-- üîç SEARCH BAR -->
    <input 
      type="text"
      id="search"
      placeholder="Nom, membre, lieu, date..."
      autocomplete="off"
    />

    <h2>Liste des artistes</h2>
    <h5>‚ö†Ô∏è Si les artistes ne s'affichent pas, veuillez rafra√Æchir la page.</h5>

    <div id="artist-box">
      <div id="api-content" style="padding:10px; border:1px solid #ccc;"></div>
    </div>

    <script>
      let allArtists = [];

      function displayArtists(artists) {
        const container = document.getElementById('api-content');
        container.innerHTML = "";

        artists.forEach(artist => {
          const div = document.createElement('div');
          div.style.border = "1px solid #ccc";
          div.style.margin = "5px";
          div.style.padding = "5px";
          div.style.display = "flex";
          div.style.alignItems = "center";
          div.style.gap = "10px";

          div.innerHTML = `
            <img src="${artist.image}" alt="${artist.name}" style="width:50px;height:50px;object-fit:cover;">
            <div>
              <strong>${artist.name}</strong><br>
              Premier album: ${artist.firstAlbum}<br>
              Cr√©ation: ${artist.creationDate}<br>
              Membres: ${artist.members.join(", ")}<br>
            </div>
          `;
          container.appendChild(div);
        });
      }

      function sortArtists() {
        displayArtists([...allArtists].sort((a, b) =>
          a.name.localeCompare(b.name)
        ));
      }

      function sortArtistsByCreationDate() {
        displayArtists([...allArtists].sort(
          (a, b) => a.creationDate - b.creationDate
        ));
      }

      function premierAlbum() {
        displayArtists([...allArtists].sort((a, b) => {
          const dateA = new Date(a.firstAlbum.split("-").reverse().join("-"));
          const dateB = new Date(b.firstAlbum.split("-").reverse().join("-"));
          return dateA - dateB;
        }));
      }

      function numberMenber() {
        displayArtists([...allArtists].sort(
          (a, b) => b.members.length - a.members.length
        ));
      }

      /* üîç SEARCH MULTI-CHAMPS */
      document.addEventListener("DOMContentLoaded", () => {
        const searchInput = document.getElementById("search");

        searchInput.addEventListener("input", () => {
          const query = searchInput.value.toLowerCase();

          const filtered = allArtists.filter(artist => {
            const searchableText = `
              ${artist.name}
              ${artist.members.join(" ")}
              ${artist.firstAlbum}
              ${artist.creationDate}
            `.toLowerCase();

            return searchableText.includes(query);
          });

          displayArtists(filtered);
        });
      });

      /* üì° FETCH ARTISTS */
      fetch('/api/artists')
        .then(response => response.json())
        .then(data => {
          allArtists = data;
          displayArtists(allArtists);
        })
        .catch(err => {
          document.getElementById('api-content').textContent =
            "Erreur de chargement : " + err;
        });
    </script>
    <br>
  </div>
</div>

<footer>
  <h2>Credit: </h2>
  <ul>
    <li>evann-g</li>
    <li>shap</li>
    <li>Corrailius</li>
  </ul>
</footer>

</body>
</html>